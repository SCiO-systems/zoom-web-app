<!DOCTYPE html>
<html lang="en">
<head>

    <link href="https://source.zoom.us/1.8.0/css/react-select.css" rel="stylesheet" type="text/css"/>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">
    <script crossorigin="anonymous" src="https://kit.fontawesome.com/2e0d3a5f6b.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>



</head>
<body style="background-color:#e9ecee;">

<nav class="navbar navbar-inverse navbar-fixed-top" id="nav-tool" style="display: none">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">Zoom WebSDK</a>
        </div>
        <div class="websdktest" id="navbar">
            <form class="navbar-form navbar-right" id="meeting_form">
                <div class="form-group">
                    <input class="form-control allSidesRed" id="display_name" maxLength="100" name="display_name"
                           placeholder="Name" required value="1.8.0#CDN">
                </div>
                <div class="form-group">
                    <input class="form-control allSidesRed" id="meeting_number" maxLength="200" name="meeting_number"
                           placeholder="Meeting Number" required style="width:150px" value="">
                </div>
                <div class="form-group">
                    <input class="form-control allSidesRed" id="meeting_pwd" maxLength="50" name="meeting_pwd"
                           placeholder="Meeting Password" style="width:150px" value="">
                </div>
                <div class="form-group">
                    <input class="form-control allSidesRed" id="meeting_email" maxLength="50" name="meeting_email"
                           placeholder="Email option" style="width:150px" value="">
                </div>

                <div class="form-group">
                    <select class="sdk-select" id="meeting_role">
                        <option value=0>Attendee</option>
                        <option value=1>Host</option>
                        <option value=5>Assistant</option>
                    </select>
                </div>
                <div class="form-group">
                    <select class="sdk-select" id="meeting_china">
                        <option value=0>Global</option>
                        <option value=1>China</option>
                    </select>
                </div>
                <div class="form-group">
                    <select class="sdk-select" id="meeting_lang">
                        <option value="en-US">English</option>
                        <option value="de-DE">German Deutsch</option>
                        <option value="es-ES">Spanish Español</option>
                        <option value="fr-FR">French Français</option>
                        <option value="jp-JP">Japanese 日本語</option>
                        <option value="pt-PT">Portuguese Portuguese</option>
                        <option value="ru-RU">Russian Русский</option>
                        <option value="zh-CN">Chinese 简体中文</option>
                        <option value="zh-TW">Chinese 繁体中文</option>
                        <option value="ko-KO">Korean 한국어</option>
                        <option value="vi-VN">Vietnamese Tiếng Việt</option>
                        <option value="it-IT">Italian italiano</option>
                    </select>
                </div>

                <input id="copy_link_value" type="hidden" value=""/>
                <button class="btn btn-primary" id="join_meeting" type="submit">Join</button>
                <button class="btn btn-primary" id="clear_all" type="submit">Clear</button>
                <button class="btn btn-primary" id="copy_join_link" link=""
                        onclick="window.copyJoinLink('#copy_join_link')" type="button">Copy Direct join link
                </button>


            </form>
        </div>
        <!--/.navbar-collapse -->
    </div>
</nav>

<div class="row" style="margin-bottom: 50px;">
    <div class="container-fluid" id="navBarContainer" style="padding-right:0px;padding-left: 0px">
        <nav class=" navbar fixed-top scrolling-navbar white navbar-expand-md font-weight-500 font-bigger"
             id="navbar"
             role="navigation">
            <div class="row" style="width:100%">
                <div class="col">

                    <a aria-current="page" class="navbar-brand px-1 py-0 mr-0 active"
                       data-test="navbar-brand">

                        <img alt="cacip logo"
                             class="d-inline-block mx-3 nav-logo-colored"
                             src="images/logo-horizontal-colored.edd3d535.png"
                             style="width:158px;height:50px;float:left;margin-left: 50px"
                             title="Central Asia Climate Information Platform | CACIP">

                    </a>
                </div>

                <div class="col">

                    <a aria-current="page" style="float:right" class="navbar-brand px-1 py-0 mr-0 active"
                       data-test="navbar-brand">
                        <img alt="zoom logo"
                             class="d-inline-block mx-3 nav-logo-colored"
                             src="images/Powered-by-Zoom.png"
                             style="height:50px;float:right;margin-right: 50px"
                        >
                    </a>
                </div>
            </div>

        </nav>
    </div>
</div>

<div class="container" style="margin-top: 50px">
    <div class="row">
        <div class="col-lg-6" style="margin-bottom: 40px;">

            <div class="card">
                <h4 class="text-center">Meeting Details</h4>

                <div class="card-body" style="
    padding-top: 0px;
">
                    <div class="row">
                        <div class="col-lg-6" style="
    padding-top: 20px;
">
                            <input autocomplete="new-password" class=" form-control allSidesRed" id="hostId"
                                   maxlength="50" name="host id" onclick="AddListenerValidateMeetingDetails()"
                                   placeholder="Host Name" style="margin-bottom:10px;width: 100%;">

                            <input autocomplete="new-password" class=" form-control allSidesRed"
                                   id="hostEmail" maxlength="50" onclick="AddListenerValidateMeetingDetails()"
                                   placeholder="Host Email" style="margin-bottom:10px;min-width:130px">
                            <div style="display:inline-block;position:relative!important">
                                <button class="btn btn-primary" name="clear" onclick="ClearMeetingDetails()"
                                        style="margin-top: 10px;">Clear
                                </button>
                            </div>
                        </div>
                        <div class="col-lg-6" style="
    padding-top: 20px;
">


                            <input autocomplete="new-password" class=" form-control allSidesRed"
                                   id="meetingId" maxlength="50"
                                   onclick="AddListenerValidateMeetingDetails(); disableButtonsEmailCopy()"
                                   onkeypress="return onlyNumberKey(event)" placeholder="Meeting Id"
                                   style="margin-bottom:10px;width: 100%;">

                            <div style="margin-bottom: 10px;position:relative!important;">
                                <input class="form-control allSidesRed" id="meetingPassword" name="password"
                                       onclick="AddListenerValidateMeetingDetails()" placeholder="Meeting Password "
                                       style="width: 100%;" type="password">
                                <i aria-hidden="true" class="toggle-password fa-eye fad"
                                   style="border-left:solid 1px;top:0;right:0rem;position:absolute;padding: 10px;min-width: 40px;z-index:1024;"
                                   toggle="#meetingPassword"></i>
                            </div>

                            <div style="display:inline-block;position:relative!important;">
                                <button class="btn btn-primary disable-button-meeting" id="startMeeting" name="start">
                                    Start Meeting
                                </button>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6" style="margin-bottom: 40px;">
            <div class="card">
                <div class="card-body">
                    <h5>Email Subject</h5>


                    <input class=" form-control allSidesGreen" id="EmailSubject"
                           maxlength="50" onclick="AddListenerValidateMeetingDetails()"
                           placeholder="Email Subject" style="width: 100%;">

                    <h5 style="padding-top: 15px;">Email Body</h5>

                    <textarea class="form-control allSidesGreen" cols="50" id="EmailTextBox" maxlength="300"
                              name="id" rows="3" style="resize:none;margin-bottom: 10px"></textarea>
                    <button class="btn btn-primary" name="clear" onclick="resetEmailTextBox()"
                            style="margin-top: 10px;">Default Message
                    </button>


                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="card">
                <h4 class="text-center">Meeting Participants</h4>

                <div class="card-body">

                    <div class="row clearfix">
                        <div class="col-md-12 table-responsive">
                            <div class="list_wrapper">
                                <div class="d-flex flex-row">


                                    <div class="form-group flex-grow-1" style="margin-top: 16px;">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <input autocomplete="new-password"
                                                       class="form-control participants allSidesRed"
                                                       id="nameParticipant[0]" placeholder="Name">
                                            </div>
                                            <div class="col-sm-6">
                                                <input autocomplete="new-password"
                                                       class="form-control participants allSidesRed"
                                                       id="emailParticipant[0]" placeholder="Email">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group"
                                         style="margin-top: 16px;min-width: 151px;margin-bottom: 16px;margin-left: 16px;">
                                        <button class="btn btn-primary disable-button-participants"
                                                id="copyParticipant[0]"
                                                link=""
                                                onclick="window.copyJoinLink('#copyParticipant[0]')"
                                                title="copy link to clipboard">
                                            <i aria-hidden="true" class="fad fa-copy"></i></button>
                                        <button class="btn btn-primary disable-button-participants"
                                                id="envelopeParticipant[0]" onclick="sendMail(this.id); return false"
                                                title="send invitation">
                                            <i aria-hidden="true" class="fad fa-envelope"></i>
                                        </button>
                                        <button class="btn btn-primary list_add_button" style="margin-left: 20px;"
                                                type="button"><i aria-hidden="true"
                                                                 class="fad fa-plus"></i></button>
                                    </div>
                                </div>
                                <div class="flex-row" id="joinLinkTextRow[0]" style="display: none">


                                    <div class="form-group" style="min-width: 80px;margin-bottom: 16px;margin-top: 8px;">

                                        <div>
                                            <label style="">Join Link:</label>
                                        </div>

                                    </div><div class="form-group flex-grow-1">
                                    <div class="row">

                                        <div class="col-12">
                                            <input autocomplete="new-password" class="form-control participants allSidesGreen" id="joinLinkTextBox[0]" value="">
                                        </div>
                                    </div>
                                </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-primary" name="clear" onclick="ClearMeetingParticipants()"
                            style="margin-top: 10px;">Clear Participants
                    </button>

                </div>
            </div>
        </div>
    </div>

</div>

<script>

    $(document).ready(function () {
        $("#add_row").on("click", function () {
            // Dynamic Rows Code

            // Get max row id and set new id
            var newid = 0;
            $.each($("#tab_logic tr"), function () {
                if (parseInt($(this).data("id")) > newid) {
                    newid = parseInt($(this).data("id"));
                }
            });
            newid++;

            var tr = $("<tr></tr>", {
                id: "addr" + newid,
                "data-id": newid
            });

            // loop through each td and create new elements with name of newid
            $.each($("#tab_logic tbody tr:nth(0) td"), function () {
                var td;
                var cur_td = $(this);

                var children = cur_td.children();

                // add new td and element if it has a nane
                if ($(this).data("name") !== undefined) {
                    td = $("<td></td>", {
                        "data-name": $(cur_td).data("name")
                    });

                    var c = $(cur_td).find($(children[0]).prop('tagName')).clone().val("");
                    c.attr("name", $(cur_td).data("name") + newid);
                    c.appendTo($(td));
                    td.appendTo($(tr));
                } else {
                    td = $("<td></td>", {
                        'text': $('#tab_logic tr').length
                    }).appendTo($(tr));
                }
            });

            // add delete button and td
            /*
            $("<td></td>").append(
                $("<button class='btn btn-danger glyphicon glyphicon-remove row-remove'></button>")
                    .click(function() {
                        $(this).closest("tr").remove();
                    })
            ).appendTo($(tr));
            */

            // add the new row
            $(tr).appendTo($('#tab_logic'));

            $(tr).find("td button.row-remove").on("click", function () {
                $(this).closest("tr").remove();
            });
        });


        // Sortable Code
        var fixHelperModified = function (e, tr) {
            var $originals = tr.children();
            var $helper = tr.clone();

            $helper.children().each(function (index) {
                $(this).width($originals.eq(index).width())
            });

            return $helper;
        };

        $(".table-sortable tbody").sortable({
            helper: fixHelperModified
        }).disableSelection();

        $(".table-sortable thead").disableSelection();


        $("#add_row").trigger("click");
    });
</script>
<script>

    function sendMail(clickedId) {
        let participantNumber = clickedId[clickedId.length - 2];
        let meetingId = document.getElementById("meetingId").value
        let meetingPassword = document.getElementById("meetingPassword").value
        let meetingGeneratedLink = joinLinkForEmail(participantNumber);

    }

    function ClearMeetingDetails() {
        document.getElementById("meetingId").value = '';
        document.getElementById("meetingId").classList.remove("allSidesGreen");
        document.getElementById("meetingId").classList.add("allSidesRed");
        // console.log("xlll3")

        document.getElementById("meetingPassword").value = '';
        document.getElementById("meetingPassword").classList.remove("allSidesGreen");
        document.getElementById("meetingPassword").classList.add("allSidesRed");

        document.getElementById("hostEmail").value = '';
        document.getElementById("hostEmail").classList.remove("allSidesGreen");
        document.getElementById("hostEmail").classList.add("allSidesRed");

        document.getElementById("hostId").value = '';
        document.getElementById("hostId").classList.remove("allSidesGreen");
        document.getElementById("hostId").classList.add("allSidesRed");
        document.getElementById("startMeeting").classList.add("disable-button-meeting")


    }


</script>
<script>
    $(document).ready(function () {

        var x = 0; //Initial field counter
        var list_maxField = 10; //Input fields increment limitation

        //Once add button is clicked
        $('.list_add_button').click(function () {

            //Check maximum number of input fields
            if (x < list_maxField) {
                x++; //Increment field counter
                var list_fieldHTML = '<div class="d-flex flex-row">' +

                    '<div class="form-group flex-grow-1" style="margin-top: 16px;">' +
                    '<div class="row">' +
                    '<div class="col-sm-6">' +
                    '<input autocomplete="new-password" id="nameParticipant[' + x + ']"  placeholder="Name" class="form-control participants allSidesRed"/>' +
                    '</div>' +
                    '<div class="col-sm-6">' +
                    '<input autocomplete="new-password" id="emailParticipant[' + x + ']"  placeholder="Email" class="form-control participants allSidesRed"/>' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '<div class="form-group" style="margin-top: 16px;min-width: 151px;margin-bottom: 16px;margin-left: 16px;">' +
                    ' <button id="copyParticipant[' + x + ']" title="copy link to clipboard" class="btn btn-primary disable-button-participants"  link="" onclick="copyJoinLink(\'#copyParticipant[' + x + ']\')"><i class="fad fa-copy"></i> </button>' +
                    ' <button id="envelopeParticipant[' + x + ']"  onclick="sendMail(this.id); return false" title="send invitation" class="btn btn-primary disable-button-participants" ><i class="fad fa-envelope"></i> </button>' +


                    '<button type="button" style="margin-left: 24px;" href="javascript:void(0);" class="list_remove_button btn btn-danger">' +
                    '<i class="fad fa-minus"></i></button>' +


                    '</div>' +
                    '</div>' +

                    '<div class="flex-row" id="joinLinkTextRow['+x+']"  style="display: none;"> ' +
                    '<div class="form-group" style="min-width: 80px;margin-bottom: 16px;margin-top: 8px;">' +

                    '<div>' +
                    '<label style="">Join Link:</label>\n' +
                    '</div>' +
                    '</div><div class="form-group flex-grow-1">' +
                    '<div class="row">' +
                    '<div class="col-12">' +
                    '<input autocomplete="new-password" class="form-control participants allSidesGreen" id="joinLinkTextBox['+x+']" value="">\n' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>'

                    // '<div class="col-md-11">' +
                    // '<div class="row" style="margin-top: 3px;margin-bottom: 8px;display: none"  id="joinLinkTextRow[' + x + ']">' +
                    // '<label style="">Join Link:</label>' +
                    // '<input id="joinLinkTextBox[' + x + ']" value=\'\'  style="width:85%;display: inline-block" class="form-control participants allSidesGreen"/>' +
                    // '</div>' +
                    // '</div>'


                ;


                //New input field html
                $('.list_wrapper').append(list_fieldHTML); //Add field html

                let participant = document.getElementById("copyParticipant[" + x + "]");
                let envelopeParticipant = document.getElementById("envelopeParticipant[" + x + "]");


                participant.classList.add("disable-button-participants")
                envelopeParticipant.classList.add("disable-button-participants")

            }

            AddListenerValidateEmail(x);


        });

        //Once remove button is clicked
        $('.list_wrapper').on('click', '.list_remove_button', function () {
            $(this).closest('div.flex-row').remove(); //Remove field html
            document.getElementById("joinLinkTextRow[" + x + "]").remove();

            x--; //Decrement field counter
        });
    });
</script>


<script>
    $(".toggle-password").click(function () {

        $(this).toggleClass("fad fa-eye fad fa-eye-slash");
        var input = $($(this).attr("toggle"));
        if (input.attr("type") == "password") {
            input.attr("type", "text");
        } else {
            input.attr("type", "password");
        }
    });
</script>

<script>
    function disableButtonsEmailCopy() {
        let i;
        for (x = 0; x < 11; x++) {
            try {

                const typer = document.getElementById("emailParticipant[" + x + "]");

                // console.log(typer.value)
                const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                let isValid = re.test(String(typer.value.toString()).toLowerCase());
                let participant = document.getElementById("copyParticipant[" + x + "]")
                let envelopeParticipant = document.getElementById("envelopeParticipant[" + x + "]")
                let nameParticipant = document.getElementById("nameParticipant[" + x + "]").value
                let meetingId = document.getElementById("meetingId").value
                let meetingPassword = document.getElementById("meetingPassword").value
                let emailParticipantZero = document.getElementById("emailParticipant[" + x + "]").value;
                let emailTextBox = document.getElementById("EmailTextBox").value;
                let emailSubject = document.getElementById("EmailSubject").value;

                if (isValid != true) {
                    if (emailParticipantZero.length > 0) {

                        typer.classList.remove("allSidesGreen");
                        typer.classList.add("allSidesRed");
                    } else {
                        try {
                            document.getElementById("joinLinkTextRow[" + x + "]").classList.remove("d-flex");

                            document.getElementById("joinLinkTextRow[" + x + "]").style.display = "none"
                        } catch (e) {
                        }

                    }

                    participant.classList.add("disable-button-participants")
                    envelopeParticipant.classList.add("disable-button-participants")

                } else {
                    if (emailParticipantZero.length > 0) {

                        typer.classList.remove("allSidesRed");
                        typer.classList.add("allSidesGreen");
                    } else {
                        try {
                            document.getElementById("joinLinkTextRow[" + x + "]").classList.remove("d-flex");

                            document.getElementById("joinLinkTextRow[" + x + "]").style.display = "none"
                        } catch (e) {
                        }

                    }

                    if ((nameParticipant.length > 0) && (meetingId.length > 0) && (meetingPassword.length > 0) && (emailTextBox.length > 0) && (emailSubject.length > 0)) {
                        // console.log("XXXXXXXX")

                        participant.classList.remove("disable-button-participants")
                        envelopeParticipant.classList.remove("disable-button-participants")

                    } else {
                        participant.classList.add("disable-button-participants")
                        envelopeParticipant.classList.add("disable-button-participants")
                        // console.log("X --> "+x)
                        try {
                            document.getElementById("joinLinkTextRow[" + x + "]").classList.remove("d-flex");

                            document.getElementById("joinLinkTextRow[" + x + "]").style.display = "none"
                        } catch (e) {
                        }

                    }
                }
            } catch (e) {
            }

        }


    }

    function ClearMeetingParticipants() {






        for (let i = 0; i < 11; i++) {
            try {
                document.getElementsByClassName("participants")[i].value = '';
                document.getElementsByClassName("participants")[i].classList.remove("allSidesGreen");
                document.getElementsByClassName("participants")[i].classList.add("allSidesRed");
                document.getElementsByClassName("emailParticipant")[i].value = '';
                document.getElementsByClassName("emailParticipant")[i].classList.remove("allSidesGreen");
                document.getElementsByClassName("emailParticipant")[i].classList.add("allSidesRed");
            } catch (e) {

            }

        }
        disableButtonsEmailCopy();
    }

    function AddListenerValidateEmail(x) {
        try {
            /////****Event Listener for Email Validation****////////
            let timer, timeoutVal = 500; // time it takes to wait for user to stop typing in ms
            const typer = document.getElementById("emailParticipant[" + x + "]");
            typer.addEventListener('keypress', handleKeyPress);
            typer.addEventListener('keyup', handleKeyUp);
            document.getElementById("nameParticipant[" + x + "]").addEventListener('keypress', handleKeyPress);
            document.getElementById("nameParticipant[" + x + "]").addEventListener('keyup', handleKeyUp);

            document.getElementById("EmailTextBox").addEventListener('keypress', handleKeyPress);
            document.getElementById("EmailTextBox").addEventListener('keyup', handleKeyUp);

            // when user is pressing down on keys, clear the timeout
            function handleKeyPress(e) {
                window.clearTimeout(timer);
            }

            // when the user has stopped pressing on keys, set the timeout
            // if the user presses on keys before the timeout is reached, then this timeout is canceled
            function handleKeyUp(e) {
                window.clearTimeout(timer); // prevent errant multiple timeouts from being generated
                timer = window.setTimeout(() => {
                    const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                    let isValid = re.test(String(typer.value.toString()).toLowerCase());
                    let participant = document.getElementById("copyParticipant[" + x + "]")
                    let envelopeParticipant = document.getElementById("envelopeParticipant[" + x + "]")
                    let nameParticipant = document.getElementById("nameParticipant[" + x + "]").value
                    let meetingId = document.getElementById("meetingId").value
                    let meetingPassword = document.getElementById("meetingPassword").value
                    let emailParticipantZero = document.getElementById("emailParticipant[" + x + "]").value;
                    let emailTextBox = document.getElementById("EmailTextBox").value;
                    let emailSubject = document.getElementById("EmailSubject").value;


                    if (nameParticipant.length > 0) {
                        document.getElementById("nameParticipant[" + x + "]").classList.remove("allSidesRed");
                        document.getElementById("nameParticipant[" + x + "]").classList.add("allSidesGreen");

                    } else {
                        document.getElementById("nameParticipant[" + x + "]").classList.remove("allSidesGreen");
                        document.getElementById("nameParticipant[" + x + "]").classList.add("allSidesRed");
                        try {
                            document.getElementById("joinLinkTextRow[" + x + "]").classList.remove("d-flex");

                            document.getElementById("joinLinkTextRow[" + x + "]").style.display = "none"
                        } catch (e) {
                        }
                    }


                    if (isValid != true) {
                        if (emailParticipantZero.length > 0) {

                            typer.classList.remove("allSidesGreen");
                            typer.classList.add("allSidesRed");
                        } else {
                            try {
                                document.getElementById("joinLinkTextRow[" + x + "]").classList.remove("d-flex");

                                document.getElementById("joinLinkTextRow[" + x + "]").style.display = "none"
                            } catch (e) {
                            }

                        }

                        participant.classList.add("disable-button-participants")
                        envelopeParticipant.classList.add("disable-button-participants")


                    } else {
                        if (emailParticipantZero.length > 0) {

                            typer.classList.remove("allSidesRed");
                            typer.classList.add("allSidesGreen");
                        } else {
                            try {
                                document.getElementById("joinLinkTextRow[" + x + "]").classList.remove("d-flex");

                                document.getElementById("joinLinkTextRow[" + x + "]").style.display = "none"
                            } catch (e) {
                            }
                        }

                        if ((nameParticipant.length > 0) && (meetingId.length > 0) && (meetingPassword.length > 0) && (emailTextBox.length > 0) && (emailSubject.length > 0)) {
                            // console.log("SSSSSS")

                            participant.classList.remove("disable-button-participants")
                            envelopeParticipant.classList.remove("disable-button-participants")
                        } else {
                            // console.log("sssssssss")

                            participant.classList.add("disable-button-participants")
                            envelopeParticipant.classList.add("disable-button-participants")
                            try {
                                document.getElementById("joinLinkTextRow[" + x + "]").classList.remove("d-flex");

                                document.getElementById("joinLinkTextRow[" + x + "]").style.display = "none"
                            } catch (e) {
                            }

                        }
                    }

                }, timeoutVal);
            }
        }catch (e) {
            
        }
    }

    /////****--------------------------------------****////////
    function AddListenerValidateMeetingDetails() {
        disableButtonsEmailCopy();


        let timer, timeoutVal = 500; // time it takes to wait for user to stop typing in ms

        document.getElementById("hostId").addEventListener('keypress', handleKeyPress);
        document.getElementById("hostId").addEventListener('keyup', handleKeyUp);
        document.getElementById("hostEmail").addEventListener('keypress', handleKeyPress);
        document.getElementById("hostEmail").addEventListener('keyup', handleKeyUp);
        document.getElementById("meetingId").addEventListener('keypress', handleKeyPress);
        document.getElementById("meetingId").addEventListener('keyup', handleKeyUp);
        document.getElementById("meetingPassword").addEventListener('keypress', handleKeyPress);
        document.getElementById("meetingPassword").addEventListener('keyup', handleKeyUp);

        // when user is pressing down on keys, clear the timeout
        function handleKeyPress(e) {
            window.clearTimeout(timer);
        }

        // when the user has stopped pressing on keys, set the timeout
        // if the user presses on keys before the timeout is reached, then this timeout is canceled
        function handleKeyUp(e) {
            window.clearTimeout(timer); // prevent errant multiple timeouts from being generated
            timer = window.setTimeout(() => {

                let hostName = document.getElementById("hostId").value
                let hostEmail = document.getElementById("hostEmail").value
                let meetingId = document.getElementById("meetingId").value
                let meetingPassword = document.getElementById("meetingPassword").value

                const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                let isValid = re.test(String(document.getElementById("hostEmail").value.toString()).toLowerCase());

                if (hostName.length > 0) {
                    document.getElementById("hostId").classList.remove("allSidesRed");
                    document.getElementById("hostId").classList.add("allSidesGreen");

                } else {
                    document.getElementById("hostId").classList.remove("allSidesGreen");
                    document.getElementById("hostId").classList.add("allSidesRed");

                }
                if (meetingId.length > 0) {
                    document.getElementById("meetingId").classList.remove("allSidesRed");
                    document.getElementById("meetingId").classList.add("allSidesGreen");

                } else {
                    document.getElementById("meetingId").classList.remove("allSidesGreen");
                    document.getElementById("meetingId").classList.add("allSidesRed");
                    disableButtonsEmailCopy()
                    // console.log("rtyhr")


                }
                if (meetingPassword.length > 0) {
                    document.getElementById("meetingPassword").classList.remove("allSidesRed");
                    document.getElementById("meetingPassword").classList.add("allSidesGreen");
                } else {
                    document.getElementById("meetingPassword").classList.remove("allSidesGreen");
                    document.getElementById("meetingPassword").classList.add("allSidesRed");
                }
                if (!(hostEmail.length > 0)) {
                    document.getElementById("hostEmail").classList.remove("allSidesGreen");
                    document.getElementById("hostEmail").classList.add("allSidesRed");
                }

                if (hostEmail.length > 0) {

                    if (isValid != true) {
                        document.getElementById("hostEmail").classList.remove("allSidesGreen");
                        document.getElementById("hostEmail").classList.add("allSidesRed");
                    } else {
                        document.getElementById("hostEmail").classList.remove("allSidesRed");
                        document.getElementById("hostEmail").classList.add("allSidesGreen");
                    }
                }


                if (isValid == true) {
                    if ((hostName.length > 0) & (hostEmail.length > 0) & (meetingId.length > 0) & (meetingPassword.length > 0)) {
                        // console.log("I AM HERE")
                        document.getElementById("startMeeting").classList.remove("disable-button-meeting")
                        document.getElementById("startMeeting").style.marginTop = "8px"

                    } else {
                        // console.log("argrg")
                        document.getElementById("startMeeting").classList.add("disable-button-meeting")
                    }
                    disableButtonsEmailCopy();

                }

            }, timeoutVal);
        }
    }
</script>

<script>
    /////****Event Listener for Email Validation****////////
    let timer, timeoutVal = 500; // time it takes to wait for user to stop typing in ms
    const typer = document.getElementById("emailParticipant[" + 0 + "]");
    typer.addEventListener('keypress', handleKeyPress);
    typer.addEventListener('keyup', handleKeyUp);
    document.getElementById("nameParticipant[" + 0 + "]").addEventListener('keypress', handleKeyPress);
    document.getElementById("nameParticipant[" + 0 + "]").addEventListener('keyup', handleKeyUp);
    document.getElementById("EmailTextBox").addEventListener('keypress', handleKeyPress);
    document.getElementById("EmailTextBox").addEventListener('keyup', handleKeyUp);
    document.getElementById("meetingId").addEventListener('keypress', handleKeyPress);
    document.getElementById("meetingId").addEventListener('keyup', handleKeyUp);
    document.getElementById("meetingPassword").addEventListener('keypress', handleKeyPress);
    document.getElementById("meetingPassword").addEventListener('keyup', handleKeyUp);
    document.getElementById("EmailSubject").addEventListener('keypress', handleKeyPress);
    document.getElementById("EmailSubject").addEventListener('keyup', handleKeyUp);

    // when user is pressing down on keys, clear the timeout
    function handleKeyPress(e) {
        window.clearTimeout(timer);
    }

    // when the user has stopped pressing on keys, set the timeout
    // if the user presses on keys before the timeout is reached, then this timeout is canceled
    function handleKeyUp(e) {
        window.clearTimeout(timer); // prevent errant multiple timeouts from being generated
        timer = window.setTimeout(() => {
            const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            let isValid = re.test(String(typer.value.toString()).toLowerCase());
            let participant = document.getElementById("copyParticipant[" + 0 + "]");
            let envelopeParticipant = document.getElementById("envelopeParticipant[" + 0 + "]");
            let nameParticipant = document.getElementById("nameParticipant[" + 0 + "]").value;
            let meetingId = document.getElementById("meetingId").value
            let meetingPassword = document.getElementById("meetingPassword").value
            let emailParticipantZero = document.getElementById("emailParticipant[" + 0 + "]").value;
            let emailTextBox = document.getElementById("EmailTextBox").value;
            let emailSubject = document.getElementById("EmailSubject").value;


            if (emailSubject.length > 0) {
                document.getElementById("EmailSubject").classList.remove("allSidesRed");
                document.getElementById("EmailSubject").classList.add("allSidesGreen");

            } else {
                document.getElementById("EmailSubject").classList.remove("allSidesGreen");
                document.getElementById("EmailSubject").classList.add("allSidesRed");
                try {
                    document.getElementById("joinLinkTextRow[" + 0 + "]").style.display = "none"
                } catch (e) {
                }

            }
            disableButtonsEmailCopy();

            if (emailTextBox.length > 0) {
                document.getElementById("EmailTextBox").classList.remove("allSidesRed");
                document.getElementById("EmailTextBox").classList.add("allSidesGreen");

            } else {
                document.getElementById("EmailTextBox").classList.remove("allSidesGreen");
                document.getElementById("EmailTextBox").classList.add("allSidesRed");
                try {
                    document.getElementById("joinLinkTextRow[" + 0 + "]").style.display = "none"
                } catch (e) {
                }

            }


            if (nameParticipant.length > 0) {
                document.getElementById("nameParticipant[" + 0 + "]").classList.remove("allSidesRed");
                document.getElementById("nameParticipant[" + 0 + "]").classList.add("allSidesGreen");

            } else {
                document.getElementById("nameParticipant[" + 0 + "]").classList.remove("allSidesGreen");
                document.getElementById("nameParticipant[" + 0 + "]").classList.add("allSidesRed");
                try {
                    document.getElementById("joinLinkTextRow[" + 0 + "]").style.display = "none"
                } catch (e) {
                }


            }


            if (isValid != true) {
                if (emailParticipantZero.length > 0) {
                    typer.classList.remove("allSidesGreen");
                    typer.classList.add("allSidesRed");
                } else {
                    try {
                        document.getElementById("joinLinkTextRow[" + 0 + "]").classList.remove("d-flex");
                        document.getElementById("joinLinkTextRow[" + 0 + "]").style.display = "none";
                    } catch (e) {
                    }

                }

                participant.classList.add("disable-button-participants")
                envelopeParticipant.classList.add("disable-button-participants")

            } else {
                if (emailParticipantZero.length > 0) {

                    typer.classList.remove("allSidesRed");
                    typer.classList.add("allSidesGreen");
                }
                if ((nameParticipant.length > 0) && (meetingId.length > 0) && (meetingPassword.length > 0) && (emailTextBox.length > 0) && (emailSubject.length > 0)) {
                    // console.log("AAAAAAA")

                    participant.classList.remove("disable-button-participants")
                    envelopeParticipant.classList.remove("disable-button-participants")

                } else {
                    // console.log("wwwwwwwwwwwwww")

                    participant.classList.add("disable-button-participants")
                    envelopeParticipant.classList.add("disable-button-participants")
                    try {
                        document.getElementById("joinLinkTextRow[" + 0 + "]").classList.remove("d-flex");

                        document.getElementById("joinLinkTextRow[" + 0 + "]").style.display = "none"
                    } catch (e) {
                    }

                }
            }
            disableButtonsEmailCopy();

        }, timeoutVal);
    }

    /////****--------------------------------------****////////
</script>


<script>
    function onlyNumberKey(evt) {

        // Only ASCII charactar in that range allowed
        var ASCIICode = (evt.which) ? evt.which : evt.keyCode
        if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57))
            return false;
        return true;
    }
</script>

<script src="https://source.zoom.us/1.8.0/lib/vendor/react.min.js"></script>
<script src="https://source.zoom.us/1.8.0/lib/vendor/react-dom.min.js"></script>
<script src="https://source.zoom.us/1.8.0/lib/vendor/redux.min.js"></script>
<script src="https://source.zoom.us/1.8.0/lib/vendor/redux-thunk.min.js"></script>
<script src="https://source.zoom.us/1.8.0/lib/vendor/jquery.min.js"></script>
<script src="https://source.zoom.us/1.8.0/lib/vendor/lodash.min.js"></script>
<script src="https://source.zoom.us/zoom-meeting-1.8.0.min.js"></script>


<script src="js/tool.js"></script>
<script src="js/vconsole.min.js"></script>
<script src="js/index.js"></script>

<script>
    document.getElementById("EmailTextBox").value = "CACIP is inviting you to a scheduled Zoom meeting.\n";
    document.getElementById("EmailSubject").value = "CACIP Zoom Meeting Invitation\n";

    function resetEmailTextBox() {
        document.getElementById("EmailTextBox").value = "CACIP is inviting you to a scheduled Zoom meeting.\n";
        document.getElementById("EmailSubject").value = "CACIP Zoom Meeting Invitation\n";

        document.getElementById("EmailTextBox").classList.remove("allSidesRed");
        document.getElementById("EmailTextBox").classList.add("allSidesGreen");

        document.getElementById("EmailSubject").classList.remove("allSidesRed");
        document.getElementById("EmailSubject").classList.add("allSidesGreen");

        disableButtonsEmailCopy();
    }

    function cleanEmailTextBox() {
        document.getElementById("EmailTextBox").value = "";
        disableButtonsEmailCopy();
    }
</script>

<script type="text/javascript">
    AddListenerValidateEmail();
</script>

<script>



    document.getElementById("zmmtg-root").style.display = "none"
    document.getElementById("nav-tool").style.display = "none"

    let participantZero = document.getElementById("copyParticipant[0]")

    let envelopeParticipantZero = document.getElementById("envelopeParticipant[0]")
    participantZero.classList.add("disable-button-participants")
    envelopeParticipantZero.classList.add("disable-button-participants")

    var hs = document.getElementsByTagName('style');


    for (var x=0; x < 15; x++) {
        for (var i=0, max = 10; i < max; i++) {
            try {hs[i].parentNode.removeChild(hs[i]);}catch (e) {}}
    }
</script>

<link href="css/zoom.css" rel="stylesheet" type="text/css">

</body>
</html>